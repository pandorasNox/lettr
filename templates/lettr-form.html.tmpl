
{{ define "lettr-form" }}
  <div id="lettr-container" hx-ext="response-targets">  
    <h2 class="text-center">{{ if .IsSolved }}SOLVED{{ else if .IsLoose }}YOU LOOSE{{ else }}unsolved{{ end }}</h2>
    <div class="flex content-center">
      <form
        name="lettr" hx-post="/lettr" hx-target="#lettr-container" class="m-auto" hx-target-error="#any-errors"
        {{ if .IsSolved }}inert{{ end }}
      >
          <div id="any-errors" class="min-h-6 text-red-600 dark:text-red-400"></div>
          <p class="group">
            <button class="">show solution</button>
            <span class="invisible opacity-0 group-hover:opacity-100 group-hover:visible">{{ .Data.Debug }}</span>
          </p>
          <div class="grid grid-cols-5 gap-1">
            {{ if .Data }}
              {{ $canWrite := false }}
              {{ $hasWrite := .IsSolved }}
              {{ range $ri, $rowGuess := .Data.Guesses }}
                {{ range $li, $letterGuess := $rowGuess }}
                  {{ $hasValue := and (ne $letterGuess.Letter 0) (ne $letterGuess.Letter 65533) }}
                  {{ if and (not $hasValue) (not $hasWrite) }}
                    {{ $canWrite = true }}
                    {{ $hasWrite = true }}
                  {{ end }}
                  <div>
                    <input
                      {{ if and $canWrite (eq $li 0) }}autofocus{{ end }}
                      type="text"
                      maxlength="1"
                      {{ if $canWrite }}required="required"{{ else if not $hasWrite }}readonly="readonly"{{ else }}disabled="disabled"{{ end }}
                      pattern="[A-Za-z]"
                      name="r{{ $ri }}"
                      class="
                        {{ if $canWrite }}focusable{{ end }}

                        {{ if and (not $letterGuess.HitOrMiss.Exact) (not $letterGuess.HitOrMiss.Some) }}
                        bg-gray-100
                        dark:bg-gray-700
                        {{ else if $letterGuess.HitOrMiss.Exact }}
                        bg-green-400
                        dark:bg-green-700
                        {{ else if and (not $letterGuess.HitOrMiss.Exact) ($letterGuess.HitOrMiss.Some) }}
                        bg-yellow-200
                        dark:bg-yellow-700
                        {{ end }}

                        caret-transparent
                        capitalize

                        rounded
                        border-gray-400
                        dark:border-gray-600

                        w-16
                        h-16

                        text-center
                        text-4xl
                        text-gray-600

                        dark:placeholder-gray-400
                        dark:text-white
                        dark:focus:ring-blue-500
                        dark:focus:border-blue-50
                      "
                      value="{{ if $hasValue }}{{ printf "%c" $letterGuess.Letter }}{{ end }}"
                      autocomplete="off"
                    />
                    <!-- "bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" -->
                  </div>
                {{ end }}
                {{ if $hasWrite }}{{ $canWrite = false }}{{ end }}
              {{ end }}
            {{ end }}
          </div>

          <input type="submit" hidden />
      </form>
    </div>
  {{ if or .IsSolved .IsLoose }}
    <div class="flex content-center">
      <button class="m-auto mt-2 inline-flex items-center px-3 py-2 text-sm font-medium text-center text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"
        hx-post="/new"
        hx-target="#lettr-container"
      >
        New Game
      </button>
    </div>
  {{ end }}
  </div>
{{ end }}


{{ define "lang-btn-inner" }}
  {{- if eq .Language "de" }}
    <svg class="h-3.5 w-3.5 rounded-full me-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" id="flag-icon-css-de" viewBox="0 0 512 512"><path fill="#ffce00" d="M0 341.3h512V512H0z"/><path d="M0 0h512v170.7H0z"/><path fill="#d00" d="M0 170.7h512v170.6H0z"/></svg>
    <span>Deutsch</span>
  {{- else -}}
    <svg class="w-5 h-5 rounded-full me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 3900 3900"><path fill="#b22234" d="M0 0h7410v3900H0z"/><path d="M0 450h7410m0 600H0m0 600h7410m0 600H0m0 600h7410m0 600H0" stroke="#fff" stroke-width="300"/><path fill="#3c3b6e" d="M0 0h2964v2100H0z"/><g fill="#fff"><g id="d"><g id="c"><g id="e"><g id="b"><path id="a" d="M247 90l70.534 217.082-184.66-134.164h228.253L176.466 307.082z"/><use xlink:href="#a" y="420"/><use xlink:href="#a" y="840"/><use xlink:href="#a" y="1260"/></g><use xlink:href="#a" y="1680"/></g><use xlink:href="#b" x="247" y="210"/></g><use xlink:href="#c" x="494"/></g><use xlink:href="#d" x="988"/><use xlink:href="#c" x="1976"/><use xlink:href="#e" x="2470"/></g></svg>
    <span>English (US)</span>
  {{ end }}
{{ end }}

{{ define "oob-lang-switch" }}
<div hx-swap-oob="innerHTML" id="language-dropdown-menu">
    {{- template "lang-btn-inner" . -}}
</div>
{{ end }}
